<!DOCTYPE html>
<html>
<head>
    <title>Web Map with Spreadsheet Data</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        #map {
            height: 500px;
        }
    </style>
</head>
<body>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>
        // Initialize the map
        var map = L.map('map').setView([115.130546, -3.078507], 5);

        // Add a tile layer
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: 'Map data Â© <a href="https://openstreetmap.org">OpenStreetMap</a> contributors'
        }).addTo(map);

        // URL of your Google Spreadsheet CSV export
        var spreadsheetUrl = 'https://docs.google.com/spreadsheets/d/1834wsMcpxIUZZQoj5WP77RoyuxP6OwnGT48cWqiJGEg/edit?usp=sharing';

        // Fetch data from the spreadsheet
        fetch(spreadsheetUrl)
            .then(response => response.text())
            .then(data => {
                // Split CSV data into lines and parse
                var lines = data.split('\n');
                var markers = [];

                // Loop through each line (excluding header)
                for (var i = 1; i < lines.length; i++) {
                    var fields = lines[i].split(',');
                    var lat = parseFloat(fields[0]);
                    var lng = parseFloat(fields[1]);
                    var title = fields[2];

                    if (!isNaN(lat) && !isNaN(lng)) {
                        markers.push({
                            lat: lat,
                            lng: lng,
                            title: title
                        });
                    }
                }

                // Add markers to the map
                markers.forEach(marker => {
                    L.marker([marker.lat, marker.lng])
                        .addTo(map)
                        .bindPopup(marker.title);
                });
            })
            .catch(error => console.error('Error fetching data:', error));
    </script>
</body>
</html>
